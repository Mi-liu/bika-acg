import{u as z,g as P,_ as V}from"./index-GoDgw8E1.js";/* empty css                   *//* empty css               */import{r as B,t as J,aq as G,f as K,I as p,x as c,J as n,G as l,L as i,u as s,O as d,a2 as r,v as k,F as w,af as y,M as T}from"./vue-vendor-Ca7P3bJW.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-C8WYWAyV.js";import{_ as D}from"./index.vue_vue_type_script_setup_true_lang-D0FFVrJc.js";import{a as X,f as Z,b as ee}from"./comic-CGO78TYS.js";import{H as te,I as oe,C as le,J as se,K as ae}from"./icons-CYK57vyT.js";import{m as ne,l as ie,f as re,n as ce,o as de,d as ue,p as fe,q as pe}from"./element-plus-DvbWlh34.js";import{H as _e}from"./vue-hooks-plus-DBdGNJzO.js";import"./utils-Rmfb0WWx.js";/* empty css                         */function me(C,u){let m=1;const v={[u.key]:[]},o=B(v);function g(){u.beforeRequest(m,m===1?void 0:o.value)&&C(m++).then(x=>{const L=o.value[u.key]||[],I=x[u.key]||[];o.value={...x,[u.key]:[...L,...I]},g()})}return g(),{data:o}}const ve={class:"max-w-1100px mx-auto"},he={class:"h-400px flex p4 rounded-2 bg-[--el-color-white] shadow-[--el-box-shadow-light]"},xe={class:"flex-1 flex flex-col justify-between ml overflow-hidden"},ke={class:"flex-1 overflow-hidden flex flex-col"},we={class:"flex flex-col space-y-3"},ye={class:"text-26px"},ge={class:"flex gap-2"},be={class:"mt-2 flex flex-wrap gap-2"},Ce={class:"flex flex-wrap gap-10px cursor-pointer mt"},Le={class:"flex mt"},Ie={class:"ml-auto flex items-center gap-2"},Te={class:"w-full flex flex-col"},Ee={class:"h-90px flex mt-4 rounded-2 bg-[--el-color-white] shadow-[--el-box-shadow-light]"},Fe={class:"p4 mt-4 rounded-2 bg-[--el-color-white] shadow-[--el-box-shadow-light]"},Oe={class:"flex items-center gap-1 text-18px font-bold"},Re={class:"mt2 text-[--el-text-color-secondary] whitespace-pre-wrap break-words"},qe={class:"p4 mt-4 rounded-2 bg-[--el-color-white] shadow-[--el-box-shadow-light]"},He={class:"flex items-center gap-1 text-18px font-bold"},Se={class:"mt3 flex flex-wrap gap-10px"},$e=J({__name:"detail",props:{id:{}},setup(C){const u=G(),m=C,v=z(),{data:o}=_e(X,{defaultParams:[m.id]});K(o,a=>{a&&v.removeItem("WATCH_LATER_LIST",a,"_id")});const g=[{label:"点赞",prop:"totalLikes"},{label:"阅读",prop:"totalViews"},{label:"评论",prop:"totalComments"}],{data:x}=me(a=>ee(m.id,a),{key:"docs",beforeRequest:(a,t)=>t===void 0?!0:a<=t.pages});B(!1);function L(a){const t=u.resolve({path:"/comic/list",query:{author:a}}).href;window.open(t,"_blank")}function I(a){v.pushItem("FOLLOW_AUTHOR_LIST",a)}function U(a){v.removeItem("FOLLOW_AUTHOR_LIST",a)}function M(a){const t=u.resolve({path:"/comic/list",query:{title:a}}).href;window.open(t,"_blank")}function E(){if(o.value!==void 0)return Z(o.value._id).then(a=>{a==="favourite"?o.value.isFavourite=!0:a==="un_favourite"&&(o.value.isFavourite=!1)})}function F(a){const t=a+1,_=x.value.docs.length,h=u.resolve({path:`/comic/chapter/${m.id}`,query:{chapter:t,maxChapter:_}}).href;window.open(h,"_blank")}return(a,t)=>{const _=ne,h=re,b=ce,N=ue,W=de,Y=fe,j=pe;return c(),p(j,{class:"bg-[--el-bg-color-page]"},{default:n(()=>{var O,R,q,H,S,$,A;return[l("div",ve,[l("div",he,[i(Q,{src:s(P)((O=s(o))==null?void 0:O.thumb.path)},null,8,["src"]),l("div",xe,[l("div",ke,[l("div",we,[l("div",ye,d((R=s(o))==null?void 0:R.title),1),l("div",ge,[i(_,{type:"info",round:""},{default:n(()=>{var e;return[r(d((e=s(o))==null?void 0:e.epsCount)+"章",1)]}),_:1}),i(_,{type:"info",round:""},{default:n(()=>{var e;return[r(d((e=s(o))==null?void 0:e.pagesCount)+"P",1)]}),_:1}),i(_,{type:"info",round:""},{default:n(()=>{var e;return[r(d((e=s(o))!=null&&e.finished?"已完结":"连载中"),1)]}),_:1}),i(_,{type:"info",round:""},{default:n(()=>{var e;return[r(d(s(ie).utc((e=s(o))==null?void 0:e.updated_at).format("YYYY-MM-DD HH:mm:ss"))+" 更新",1)]}),_:1})]),l("div",be,[(c(!0),k(w,null,y((q=s(o))==null?void 0:q.categories,e=>(c(),p(_,{class:"cursor-pointer",key:e,type:"primary",effect:"plain",onClick:f=>M(e)},{default:n(()=>[r(d(e),1)]),_:2},1032,["onClick"]))),128))]),l("div",Ce,[(c(!0),k(w,null,y((H=s(o))==null?void 0:H.tags,e=>(c(),p(_,{key:e},{default:n(()=>[r(d(e),1)]),_:2},1024))),128))])])]),l("div",Le,[i(h,{type:"primary",icon:s(te),onClick:t[0]||(t[0]=e=>F(0))},{default:n(()=>t[1]||(t[1]=[r("开始阅读")])),_:1},8,["icon"]),(S=s(o))!=null&&S.isFavourite?(c(),p(D,{key:0,onClick:E},{default:n(()=>[i(b,{class:"mr-1",size:"18",color:"var(--el-color-warning-light-3)"},{default:n(()=>[i(s(oe))]),_:1}),t[2]||(t[2]=r(" 取消收藏 "))]),_:1})):(c(),p(D,{key:1,onClick:E},{default:n(()=>[i(b,{class:"mr-1"},{default:n(()=>[i(s(le))]),_:1}),t[3]||(t[3]=r(" 收藏漫画 "))]),_:1})),l("div",Ie,[(c(!0),k(w,null,y(($=s(o))==null?void 0:$.author.split(/[、,，]\s*/),e=>(c(),p(W,{width:"70px",key:e},{reference:n(()=>[i(N,{type:"primary",underline:"always",onClick:T(f=>L(e),["stop"])},{default:n(()=>[r(d(e),1)]),_:2},1032,["onClick"])]),default:n(()=>[l("div",Te,[s(v).local.FOLLOW_AUTHOR_LIST.includes(e)?(c(),p(h,{key:0,class:"w-full",type:"danger",size:"default",onClick:T(f=>U(e),["stop"])},{default:n(()=>t[4]||(t[4]=[r(" 取消关注 ")])),_:2},1032,["onClick"])):(c(),p(h,{key:1,class:"w-full",type:"primary",size:"default",onClick:T(f=>I(e),["stop"])},{default:n(()=>t[5]||(t[5]=[r(" 关注 ")])),_:2},1032,["onClick"]))])]),_:2},1024))),128))])])])]),l("div",Ee,[(c(),k(w,null,y(g,e=>{var f;return l("div",{class:"flex-1 flex flex-col items-center justify-center",key:e.prop},[l("div",null,[i(Y,{value:(f=s(o))==null?void 0:f[e.prop]},null,8,["value"])]),l("div",null,d(e.label),1)])}),64))]),l("div",Fe,[l("div",Oe,[i(b,null,{default:n(()=>[i(s(se))]),_:1}),t[6]||(t[6]=r(" 作品简介 "))]),l("div",Re,d((A=s(o))==null?void 0:A.description),1)]),l("div",qe,[l("div",He,[i(b,null,{default:n(()=>[i(s(ae))]),_:1}),t[7]||(t[7]=r(" 章节列表 "))]),l("div",Se,[(c(!0),k(w,null,y(s(x).docs.toReversed(),(e,f)=>(c(),p(h,{class:"ml-0!",key:e.id||f,onClick:Ae=>F(f)},{default:n(()=>[r(d(e.title),1)]),_:2},1032,["onClick"]))),128))])])])]}),_:1})}}}),Ge=V($e,[["__scopeId","data-v-bc5ac59e"]]);export{Ge as default};
