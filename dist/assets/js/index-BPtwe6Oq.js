import{a as te,u as oe,s as le,g as se,f as R,h as ne,_ as ae}from"./index-GoDgw8E1.js";/* empty css               *//* empty css                   */import"./el-tooltip-l0sNRNKZ.js";/* empty css                         *//* empty css                  */import{t as ie,aq as ce,aw as re,r as de,c as ue,v as r,x as n,G as a,L as s,O as m,u as l,h as pe,J as c,F as x,af as h,I as p,ac as _e,M as v,E as fe,a2 as _}from"./vue-vendor-Ca7P3bJW.js";import{_ as me,D as B,c as ve}from"./cardAnimation-BnUrySq6.js";import{E as xe,o as he}from"./icons-CYK57vyT.js";import{_ as ge}from"./index.vue_vue_type_script_setup_true_lang-C8WYWAyV.js";import{H as ke,F as Ce}from"./vue-hooks-plus-DBdGNJzO.js";/* empty css                       *//* empty css                   */import{u as we,v as ye,q as Ee,A as be,B as Te,x as Le,n as Se,H as Ae,o as Ie,f as Re,d as Be,m as $e,G as He,E as $}from"./element-plus-DvbWlh34.js";const Oe={class:"comic-list size-full flex-1 flex flex-col"},Fe={class:"flex px py"},Pe={class:"size-full flex justify-between"},ze={class:"text-18px"},Me={class:"h-full flex-1 overflow-hidden"},Ue={key:0,class:"card-animation-grid card-grid-custom",style:{"grid-template-columns":"repeat(auto-fill, 270px)",gap:"20px"}},Ve={class:"size-full"},We={class:"w-full! aspect-3/4"},qe={class:"mt-2 flex gap-2"},De=["onClick"],Ge={class:"relative"},Ne=["onClick"],je=["onClick"],Je={class:"line-clamp-2 text-16px font-500 mt-2"},Ze={class:"text-13px mt-1 text-[--el-text-color-secondary]"},Ke={class:"text-14px text-[--el-text-color-secondary] flex"},Qe={class:"flex-1 flex gap-2 ml-2 flex-wrap"},Xe={class:"w-full flex flex-col"},Ye={class:"mt-2 flex flex-wrap gap-2"},et=ie({__name:"index",props:{title:{},isBlockedCategories:{type:Boolean,default:!0},params:{},fetch:{}},setup(H){const g=H,y=ce(),E=te(),d=oe(),T=re("CommonPaginationRef"),k=de(ne),{loading:b,data:f,run:O}=ke(e=>g.fetch(e),{manual:!0,initialData:{docs:[],total:0,page:1,pages:0,limit:B},onError:e=>{console.error("获取漫画列表失败:",e)}});function F(){var e;(e=T.value)==null||e.reset()}function L(e){f.value&&(f.value.docs=[]),O({page:e.currentPage,s:k.value,...g.params})}L({currentPage:1});const P=ue(()=>f.value?g.isBlockedCategories?f.value.docs.filter(e=>!e.categories.some(t=>E.comic.blockedCategories.includes(t))):f.value.docs:[]);async function z(e){await He.alert(`是否屏蔽分类：${e}`,"提示",{showCancelButton:!0}),E.comic.blockedCategories.includes(e)?$.warning("分类已被屏蔽，请勿重复添加"):(E.comic.blockedCategories.push(e),$.success("分类已被屏蔽"))}const C=ve.leftToRight;function M(e){const t=y.resolve(`/comic/detail/${e._id}`).href;window.open(t,"_blank")}function U(e){const t=y.resolve({path:"/comic/list",query:{author:e}}).href;window.open(t,"_blank")}function V(e){d.pushItem("FOLLOW_AUTHOR_LIST",e)}function W(e){d.removeItem("FOLLOW_AUTHOR_LIST",e)}function q(e){d.pushItem("WATCH_LATER_LIST",Ce(e))}function D(e){d.removeItem("WATCH_LATER_LIST",e,"_id")}function G(e){const t=y.resolve({path:"/comic/list",query:{title:e}}).href;window.open(t,"_blank")}return(e,t)=>{var I;const N=ye,j=we,u=Te,J=be,S=Se,Z=Le,K=Ae,Q=Be,A=Re,X=Ie,Y=$e,ee=Ee;return n(),r("div",Oe,[a("div",Fe,[a("div",Pe,[a("div",ze,m(g.title||"漫画列表"),1),s(j,{modelValue:l(k),"onUpdate:modelValue":t[0]||(t[0]=o=>pe(k)?k.value=o:null),class:"w-110px!",disabled:l(b),onChange:F},{default:c(()=>[(n(!0),r(x,null,h(l(le),o=>(n(),p(N,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),s(me,{ref_key:"CommonPaginationRef",ref:T,total:((I=l(f))==null?void 0:I.total)||0,layout:"slot, ->, total, prev, pager, next, jumper","page-size":l(B),disabled:l(b),onChange:L},null,8,["total","page-size","disabled"])]),a("div",Me,[s(ee,{height:"100%"},{default:c(()=>[t[5]||(t[5]=a("div",{class:"w-full h-6px"},null,-1)),l(b)?(n(),r("div",Ue,[(n(),r(x,null,h(12,o=>s(J,{key:o,class:"rounded-2 overflow-hidden p-3 shadow-[--el-box-shadow]",loading:!0},{template:c(()=>[a("div",Ve,[a("div",We,[s(u,{class:"size-full!",variant:"image"})]),s(u,{variant:"h3",class:"w-80%! mt-2"}),s(u,{variant:"text",class:"w-60%! mt-1"}),s(u,{variant:"text",class:"w-40%! mt-1"}),a("div",qe,[s(u,{variant:"button",class:"w-50px! h-24px!"}),s(u,{variant:"button",class:"w-60px! h-24px!"}),s(u,{variant:"button",class:"w-40px! h-24px!"})])])]),_:2},1024)),64))])):(n(),p(_e,{key:1,tag:"div",class:"card-animation-grid card-grid-custom",style:{"grid-template-columns":"repeat(auto-fill, 270px)",gap:"20px"},css:!1,onBeforeEnter:l(C).onBeforeEnter,onEnter:l(C).onEnter,onLeave:l(C).onLeave,onMove:l(C).onMove},{default:c(()=>[(n(!0),r(x,null,h(l(P),o=>(n(),r("div",{key:o._id,class:"rounded-2 overflow-hidden cursor-pointer p-3 shadow-[--el-box-shadow]",onClick:i=>M(o)},[a("div",Ge,[s(ge,{src:l(se)(o.thumb.path)},null,8,["src"]),s(Z,{class:"box-item",effect:"dark",content:l(R)(l(d).local.WATCH_LATER_LIST,o._id,"_id")?"从稍后再看中移除":"添加到稍后再看",placement:"top-start"},{default:c(()=>[l(R)(l(d).local.WATCH_LATER_LIST,o._id,"_id")?(n(),r("div",{key:1,class:"absolute top-2 right-2 w-30px h-30px bg-[--el-color-info] rounded-1 flex-center",onClick:v(i=>D(o),["stop"])},[s(S,{class:"text-[--el-color-white]!"},{default:c(()=>[s(l(he))]),_:1})],8,je)):(n(),r("div",{key:0,class:"absolute top-2 right-2 w-30px h-30px bg-[--el-color-info] rounded-1 flex-center",onClick:v(i=>q(o),["stop"])},[s(S,{class:"text-[--el-color-white]!"},{default:c(()=>[s(l(xe))]),_:1})],8,Ne))]),_:2},1032,["content"])]),a("div",Je,m(o.title),1),a("div",Ze,[o.finished?(n(),p(K,{key:0,class:"mx-1",type:"primary"},{default:c(()=>t[1]||(t[1]=[_("[完结]")])),_:1})):fe("",!0),_(" "+m(o.epsCount)+"章 共 "+m(o.pagesCount)+"P ",1)]),a("div",Ke,[t[4]||(t[4]=_(" 作者: ")),a("div",Qe,[(n(!0),r(x,null,h(o.author.split(/[、,，]\s*/),i=>(n(),p(X,{key:i,width:"70px"},{reference:c(()=>[s(Q,{type:"primary",underline:"always",onClick:v(w=>U(i),["stop"])},{default:c(()=>[_(m(i),1)]),_:2},1032,["onClick"])]),default:c(()=>[a("div",Xe,[l(d).local.FOLLOW_AUTHOR_LIST.includes(i)?(n(),p(A,{key:0,class:"w-full",type:"danger",size:"default",onClick:v(w=>W(i),["stop"])},{default:c(()=>t[2]||(t[2]=[_(" 取消关注 ")])),_:2},1032,["onClick"])):(n(),p(A,{key:1,class:"w-full",type:"primary",size:"default",onClick:v(w=>V(i),["stop"])},{default:c(()=>t[3]||(t[3]=[_(" 关注 ")])),_:2},1032,["onClick"]))])]),_:2},1024))),128))])]),a("div",Ye,[(n(!0),r(x,null,h(o.categories,i=>(n(),p(Y,{key:i,closable:"",type:"primary",effect:"plain",onClose:w=>z(i),onClick:v(w=>G(i),["stop"])},{default:c(()=>[_(m(i),1)]),_:2},1032,["onClose","onClick"]))),128))])],8,De))),128))]),_:1},8,["onBeforeEnter","onEnter","onLeave","onMove"])),t[6]||(t[6]=a("div",{class:"w-full h-6px"},null,-1))]),_:1})])])}}}),mt=ae(et,[["__scopeId","data-v-2d0c8835"]]);export{mt as C};
