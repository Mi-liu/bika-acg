import{e as K,f as U,_ as Q,d as A,g as X,c as Z,i as ee,h as te,a as x,o as r,j as T,k as s,n as b,u as t,r as F,l as d,t as u,m as se,w as le,p as M,q as oe,s as ae,v as ie,x as ne,y as h,z as n,b as c,A as re,B as ce,F as $,C as E,E as de,D as ue,G as fe,H as pe,I as _e,J as O,K as me,L as ve,M as he,N as xe,O as ye}from"./index-CO2dMfik.js";import{E as ge}from"./el-popover-C23PWSx9.js";import{E as ke}from"./el-tag-sAk5FwwX.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang-Ds62hgmB.js";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang-D9KPAqpT.js";import{a as be,f as Ce,b as Se}from"./comic-C30LDdgU.js";import"./el-skeleton-item-BhkZJg9t.js";import"./scroll-BvoT1kFd.js";import"./omit-BeRo71Yy.js";const Le=K({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:U([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:U([String,Object,Array])}}),$e=A({name:"ElStatistic"}),Ee=A({...$e,props:Le,setup(C,{expose:p}){const _=C,f=X("statistic"),l=Z(()=>{const{value:a,formatter:m,precision:g,decimalSeparator:S,groupSeparator:N}=_;if(ee(m))return m(a);if(!te(a)||Number.isNaN(a))return a;let[L,k=""]=String(a).split(".");return k=k.padEnd(g,"0").slice(0,g>0?g:0),L=L.replace(/\B(?=(\d{3})+(?!\d))/g,N),[L,k].join(k?S:"")});return p({displayValue:l}),(a,m)=>(r(),x("div",{class:b(t(f).b())},[a.$slots.title||a.title?(r(),x("div",{key:0,class:b(t(f).e("head"))},[F(a.$slots,"title",{},()=>[d(u(a.title),1)])],2)):T("v-if",!0),s("div",{class:b(t(f).e("content"))},[a.$slots.prefix||a.prefix?(r(),x("div",{key:0,class:b(t(f).e("prefix"))},[F(a.$slots,"prefix",{},()=>[s("span",null,u(a.prefix),1)])],2)):T("v-if",!0),s("span",{class:b(t(f).e("number")),style:se(a.valueStyle)},u(t(l)),7),a.$slots.suffix||a.suffix?(r(),x("div",{key:1,class:b(t(f).e("suffix"))},[F(a.$slots,"suffix",{},()=>[s("span",null,u(a.suffix),1)])],2)):T("v-if",!0)],2)],2))}});var Ie=Q(Ee,[["__file","statistic.vue"]]);const Ne=le(Ie);function Te(C,p){let _=1;const f={[p.key]:[]},l=M(f);function a(){p.beforeRequest(_,_===1?void 0:l.value)&&C(_++).then(m=>{const g=l.value[p.key]||[],S=m[p.key]||[];l.value={...m,[p.key]:[...g,...S]},a()})}return a(),{data:l}}const Fe={class:"max-w-1100px mx-auto"},Oe={class:"h-400px flex p4 rounded-2 bg-[--el-color-white] shadow-[--el-box-shadow-light]"},Ae={class:"flex-1 flex flex-col justify-between ml overflow-hidden"},Re={class:"flex-1 overflow-hidden flex flex-col"},qe={class:"flex flex-col space-y-3"},He={class:"text-26px"},je={class:"flex gap-2"},Be={class:"mt-2 flex flex-wrap gap-2"},De={class:"flex flex-wrap gap-10px cursor-pointer mt"},ze={class:"flex mt"},Pe={class:"ml-auto flex items-center gap-2"},Ue={class:"w-full flex flex-col"},Ve={class:"h-90px flex mt-4 rounded-2 bg-[--el-color-white] shadow-[--el-box-shadow-light]"},Me={class:"p4 mt-4 rounded-2 bg-[--el-color-white] shadow-[--el-box-shadow-light]"},We={class:"flex items-center gap-1 text-18px font-bold"},Ye={class:"mt2 text-[--el-text-color-secondary] whitespace-pre-wrap break-words"},Ge={class:"p4 mt-4 rounded-2 bg-[--el-color-white] shadow-[--el-box-shadow-light]"},Je={class:"flex items-center gap-1 text-18px font-bold"},Ke={class:"mt3 flex flex-wrap gap-10px"},Qe=A({__name:"detail",props:{id:{}},setup(C){const p=oe(),_=C,f=ae(),{data:l}=ie(be,{defaultParams:[_.id]});ne(l,i=>{i&&f.removeItem("WATCH_LATER_LIST",i,"_id")});const a=[{label:"点赞",prop:"totalLikes"},{label:"阅读",prop:"totalViews"},{label:"评论",prop:"totalComments"}],{data:m}=Te(i=>Se(_.id,i),{key:"docs",beforeRequest:(i,o)=>o===void 0?!0:i<=o.pages});M(!1);function g(i){const o=p.resolve({path:"/comic/list",query:{author:i}}).href;window.open(o,"_blank")}function S(i){f.pushItem("FOLLOW_AUTHOR_LIST",i)}function N(i){f.removeItem("FOLLOW_AUTHOR_LIST",i)}function L(i){const o=p.resolve({path:"/comic/list",query:{title:i}}).href;window.open(o,"_blank")}function k(){if(l.value!==void 0)return Ce(l.value._id).then(i=>{i==="favourite"?l.value.isFavourite=!0:i==="un_favourite"&&(l.value.isFavourite=!1)})}function R(i){const o=i+1,y=m.value.docs.length,w=p.resolve({path:`/comic/chapter/${_.id}`,query:{chapter:o,maxChapter:y}}).href;window.open(w,"_blank")}return(i,o)=>{const y=ke,w=de,I=fe,W=me,Y=ge,G=Ne,J=xe;return r(),h(J,{class:"bg-[--el-bg-color-page]"},{default:n(()=>{var q,H,j,B,D,z,P;return[s("div",Fe,[s("div",Oe,[c(we,{src:t(re)((q=t(l))==null?void 0:q.thumb.path)},null,8,["src"]),s("div",Ae,[s("div",Re,[s("div",qe,[s("div",He,u((H=t(l))==null?void 0:H.title),1),s("div",je,[c(y,{type:"info",round:""},{default:n(()=>{var e;return[d(u((e=t(l))==null?void 0:e.epsCount)+"章",1)]}),_:1}),c(y,{type:"info",round:""},{default:n(()=>{var e;return[d(u((e=t(l))==null?void 0:e.pagesCount)+"P",1)]}),_:1}),c(y,{type:"info",round:""},{default:n(()=>{var e;return[d(u((e=t(l))!=null&&e.finished?"已完结":"连载中"),1)]}),_:1}),c(y,{type:"info",round:""},{default:n(()=>{var e;return[d(u(t(ce).utc((e=t(l))==null?void 0:e.updated_at).format("YYYY-MM-DD HH:mm:ss"))+" 更新",1)]}),_:1})]),s("div",Be,[(r(!0),x($,null,E((j=t(l))==null?void 0:j.categories,e=>(r(),h(y,{class:"cursor-pointer",key:e,type:"primary",effect:"plain",onClick:v=>L(e)},{default:n(()=>[d(u(e),1)]),_:2},1032,["onClick"]))),128))]),s("div",De,[(r(!0),x($,null,E((B=t(l))==null?void 0:B.tags,e=>(r(),h(y,{key:e},{default:n(()=>[d(u(e),1)]),_:2},1024))),128))])])]),s("div",ze,[c(w,{type:"primary",icon:t(ue),onClick:o[0]||(o[0]=e=>R(0))},{default:n(()=>o[1]||(o[1]=[d("开始阅读")])),_:1},8,["icon"]),(D=t(l))!=null&&D.isFavourite?(r(),h(V,{key:0,onClick:k},{default:n(()=>[c(I,{class:"mr-1",size:"18",color:"var(--el-color-warning-light-3)"},{default:n(()=>[c(t(pe))]),_:1}),o[2]||(o[2]=d(" 取消收藏 "))]),_:1})):(r(),h(V,{key:1,onClick:k},{default:n(()=>[c(I,{class:"mr-1"},{default:n(()=>[c(t(_e))]),_:1}),o[3]||(o[3]=d(" 收藏漫画 "))]),_:1})),s("div",Pe,[(r(!0),x($,null,E((z=t(l))==null?void 0:z.author.split(/[、,，]\s*/),e=>(r(),h(Y,{width:"70px",key:e},{reference:n(()=>[c(W,{type:"primary",underline:"always",onClick:O(v=>g(e),["stop"])},{default:n(()=>[d(u(e),1)]),_:2},1032,["onClick"])]),default:n(()=>[s("div",Ue,[t(f).local.FOLLOW_AUTHOR_LIST.includes(e)?(r(),h(w,{key:0,class:"w-full",type:"danger",size:"default",onClick:O(v=>N(e),["stop"])},{default:n(()=>o[4]||(o[4]=[d(" 取消关注 ")])),_:2},1032,["onClick"])):(r(),h(w,{key:1,class:"w-full",type:"primary",size:"default",onClick:O(v=>S(e),["stop"])},{default:n(()=>o[5]||(o[5]=[d(" 关注 ")])),_:2},1032,["onClick"]))])]),_:2},1024))),128))])])])]),s("div",Ve,[(r(),x($,null,E(a,e=>{var v;return s("div",{class:"flex-1 flex flex-col items-center justify-center",key:e.prop},[s("div",null,[c(G,{value:(v=t(l))==null?void 0:v[e.prop]},null,8,["value"])]),s("div",null,u(e.label),1)])}),64))]),s("div",Me,[s("div",We,[c(I,null,{default:n(()=>[c(t(ve))]),_:1}),o[6]||(o[6]=d(" 作品简介 "))]),s("div",Ye,u((P=t(l))==null?void 0:P.description),1)]),s("div",Ge,[s("div",Je,[c(I,null,{default:n(()=>[c(t(he))]),_:1}),o[7]||(o[7]=d(" 章节列表 "))]),s("div",Ke,[(r(!0),x($,null,E(t(m).docs.toReversed(),(e,v)=>(r(),h(w,{class:"ml-0!",key:e.id||v,onClick:Xe=>R(v)},{default:n(()=>[d(u(e.title),1)]),_:2},1032,["onClick"]))),128))])])])]}),_:1})}}}),rt=ye(Qe,[["__scopeId","data-v-bc5ac59e"]]);export{rt as default};
